<!DOCTYPE html><html><head><style type="text/css">html,body{width:100%;height:100%;padding:0;margin:0}.session-list,.break-list{display:flex;flex-direction:column;gap:.5em;padding:1em}.session-list .break,.break-list .break{display:flex;align-items:center;justify-content:space-between;gap:.5em}.session-list .session,.break-list .session{user-select:none;padding:.5em;background:#afb;border-radius:.25em}.session-list .session.used,.break-list .session.used{background:#d7d8d9}.canvas{width:100%;height:100%;margin:auto;display:flex;position:relative;padding:1em;align-items:stretch;flex:1 0 auto}.canvas .tracks{width:100%;height:100%;background:0;display:flex;gap:1em;justify-content:space-between;align-items:stretch}.canvas .tracks .track{background:#cccdce;flex:1 0 auto}.canvas .tick-field{width:1.5em}.canvas .ticks{position:absolute;pointer-events:none;inset:0;margin:1em 0}.canvas .tick{cursor:pointer;width:100%;height:0;border-top:1px solid #0ff;padding-right:.25em;position:absolute;font-size:12px;text-align:right;top:0;left:0;pointer-events:all;line-height:1em}.canvas .tick .tick-inner{user-select:none;padding:.1em .3em;background:#0ff;display:inline-block;border-radius:0 0 .25em .25em}.canvas .entries{position:absolute;pointer-events:none;inset:0}.canvas .entry{position:absolute;pointer-events:all;display:flex;align-items:center;justify-content:center;line-height:1em;user-select:none;cursor:pointer;padding-right:1em;color:#fff;background:#000;box-shadow:inset 0 0 0 1px #fff;overflow:hidden}.canvas .entry .i-close{position:absolute;top:.2em;right:.4em;font-size:.65em;cursor:pointer}.canvas .entry [ld=title]{user-select:none;padding:0 .5em;display:inline;margin:auto;overflow:hidden;text-overflow:ellipsis;white-space:pre}.canvas .refline{font-size:.75em;text-align:center;margin-top:calc(1em / 0.75);position:absolute;width:0;height:0;border-top:1px dashed red;border-bottom:1px dashed red;z-index:var(--z-float);pointer-events:none}.canvas .times{user-select:none;border-right:1px solid #000;width:1em;margin-right:.25em;position:relative}.canvas .times .time{border-top:1px solid #000;text-align:right;padding-right:.15em;font-size:.75em;line-height:1em;width:.2em;position:absolute;right:0}.canvas .times .time.half{width:.5em}.canvas .times .time.half.full{width:1.3em}</style><link rel="stylesheet" type="text/css" href="./assets/lib/bootstrap/main/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="./assets/lib/ldiconfont/main/index.min.css"><link rel="stylesheet" type="text/css" href="./assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="./assets/lib/@loadingio/bootstrap.ext/main/index.min.css"></head><body><div class="ldcv autogap scrolling" ld-scope="track-editor" ld="track-editor ldcv" data-name="track-editor"><div class="base" style="width:700px"><div class="inner"><div><div class="d-flex g-3 pb-4 px-4 align-items-center justify-content-between" ld-each="track"><div class="d-flex g-3 align-items-center"><div><div>&nbsp;</div><div>Day <span ld="day"></span></div></div><div><div>Start Time</div><div class="input-group"><select class="form-control" ld="sel" data-name="start" data-type="hour"><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option></select><select class="form-control" ld="sel" data-name="start" data-type="min"><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option><option>32</option><option>33</option><option>34</option><option>35</option><option>36</option><option>37</option><option>38</option><option>39</option><option>40</option><option>41</option><option>42</option><option>43</option><option>44</option><option>45</option><option>46</option><option>47</option><option>48</option><option>49</option><option>50</option><option>51</option><option>52</option><option>53</option><option>54</option><option>55</option><option>56</option><option>57</option><option>58</option><option>59</option></select></div></div><div class="mx-2"><div>&nbsp;</div><div>to</div></div><div><div>End Time</div><div class="input-group"><select class="form-control" ld="sel" data-name="end" data-type="hour"><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option></select><select class="form-control" ld="sel" data-name="end" data-type="min"><option>0</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>13</option><option>14</option><option>15</option><option>16</option><option>17</option><option>18</option><option>19</option><option>20</option><option>21</option><option>22</option><option>23</option><option>24</option><option>25</option><option>26</option><option>27</option><option>28</option><option>29</option><option>30</option><option>31</option><option>32</option><option>33</option><option>34</option><option>35</option><option>36</option><option>37</option><option>38</option><option>39</option><option>40</option><option>41</option><option>42</option><option>43</option><option>44</option><option>45</option><option>46</option><option>47</option><option>48</option><option>49</option><option>50</option><option>51</option><option>52</option><option>53</option><option>54</option><option>55</option><option>56</option><option>57</option><option>58</option><option>59</option></select></div></div><div><div>Duration</div><div class="form-control px-4" ld="dur"></div></div></div><div class="flec-grow-1"></div><div ld="delete"><div>&nbsp;</div><div class="btn btn-outline-danger"><i class="i-close"></i></div></div></div></div><div class="d-flex justify-content-between px-4"><div class="btn btn-outline-secondary"><span class="mr-2" t>Add</span> <i class="i-plus"></i></div><div class="btn btn-outline-secondary" data-ldcv-set="" t>Close</div></div></div></div></div><div class="d-flex g-2 flex-column p-4 h-100 h-100"><div class="rounded shadow-sm border p-2"><div class="btn btn-outline-secondary" ld="toggle-track-editor" t>Edit Tracks</div></div><div class="d-flex g-2 rwd mx-auto w-100 flex-grow-1" style="overflow:hidden"><div class="bg-light rounded flex-grow-1 border h-100" style="width:30%;overflow:scroll"><div class="break-list"><div class="break session" ld="break"><div>Break</div><select class="form-control form-control-sm" ld="break-min"><option value="10">10分</option><option value="15">15分</option><option value="20">20分</option><option value="25">25分</option><option value="30">30分</option><option value="35">35分</option><option value="40">40分</option><option value="45">45分</option><option value="50">50分</option><option value="55">55分</option><option value="60">60分</option></select><div class="btn btn-dark text-nowrap btn-sm" ld="break-add">加入</div></div></div><div class="session-list" ld="sessions"><div class="session" ld-each="session" draggable="true"><div class="font-weight-bold" ld="title"></div><div class="text-sm" ld="speaker"></div></div></div></div><div class="bg-light rounded flex-grow-1 border h-100" style="width:70%"><div class="canvas" ld="canvas" ld-scope="canvas"><div class="times" ld="times"><div class="time" ld-each="time"></div></div><div class="refline" ld="refline"></div><div class="tracks" ld="tracks"><div class="track" ld-each="track"></div></div><div class="tick-field" ld="tick-field"></div><div class="ticks" ld="ticks"><div class="tick" ld-each="tick"><div class="tick-inner" ld="tick-inner"></div></div></div><div class="entries" ld="entries"><div class="entry" ld-each="entry"><div><div class="text-sm" ld="title"></div><div class="d-flex align-items-center justify-content-center g-2"><div class="text-sm" ld="dur"></div><div class="text-sm" ld="speaker"></div><div class="text-sm" ld="time"></div></div><i class="i-close"></i></div></div></div></div></div></div></div><script type="text/javascript" src="./assets/lib/proxise/main/index.min.js" defer></script><script type="text/javascript" src="./assets/lib/@loadingio/debounce.js/main/index.min.js" defer></script><script type="text/javascript" src="./assets/lib/@loadingio/ldquery/main/index.min.js" defer></script><script type="text/javascript" src="./assets/lib/ldview/main/index.min.js" defer></script><script type="text/javascript" src="./assets/lib/ldcover/main/index.min.js" defer></script><script type="module">(function(t){return t.apply({})})(function(){var k=this;return ld$.fetch("assets/data/sample.json",{method:"GET"},{type:"json"}).then(function(t){var h,m,e,x,g,r,y,s,n,u,c,d;k.entries=[];k.ticks=[];k.tracks=[1,2,3].map(function(t){return{id:t+"",dur:8*60,start:8*60-t*10}});k.refptr={};k.sessions=t.map(function(t){return{id:Math.random().toString(36).substring(2),data:t,dur:t.duration,track:k.tracks[0].id,p:k.tracks[0].start}});h=function(t){var e,n,r;e=t.y,n=t.grain,r=t.screen;n=n||10;e=y({screen:r,p:n*Math.round(x({screen:r,y:e})/n)});return e};k.autopos=function(){var t,e,n,r,i,a,u,s,c,o,d=[];for(t=0,e=this.entries.length;t<e;++t){n=t;r=this.entries[n];for(i=n+1,a=this.entries.length;i<a;++i){u=i;s=this.entries[u];c=r.p>=s.p&&r.p<=s.p+s.dur||s.p>=r.p&&s.p<=r.p+r.dur;o=this.tracks.filter(f)[0];if(r.p<o.start||r.p+r.dur>o.start+o.dur){c=true}if(c){break}}if(c){}}return d;function f(t){return t.id===r.track}};k.restat=function(){var e=this;this.timespan={min:Math.min.apply(Math,this.tracks.map(function(t){return t.start})),max:Math.max.apply(Math,this.tracks.map(function(t){return t.start+t.dur}))};this.timespan.min=Math.floor(this.timespan.min/10)*10;this.timespan.max=Math.ceil(this.timespan.max/10)*10;return this.times=function(){var t,e,n=[];for(t=0,e=this.timespan.max-this.timespan.min;t<=e;t+=10){n.push(t)}return n}.call(this).map(function(t){return{p:t+e.timespan.min}})};k.restat();m=function(t){var e,n;e=t.y;n=ld$.find(d.get("canvas"),"[ld=tracks]",0).getBoundingClientRect();return e-n.y};e=function(t){var e,n;e=t.y;n=ld$.find(d.get("canvas"),"[ld=tracks]",0).getBoundingClientRect();return e+n.y};x=function(t){var e,n,r,i;e=t.y,n=t.screen;r=ld$.find(d.get("canvas"),"[ld=tracks]",0).getBoundingClientRect();i=n?r.y:0;return Math.round((k.timespan.max-k.timespan.min)*(e-i)/r.height+k.timespan.min)};g=function(t){var e,n,r;e=t.p;e=Math.round(e);n=e%60;r=Math.floor(e/60);return(r+"").padStart(2,"0")+":"+(n+"").padStart(2,"0")};r=function(t){return t.dur+"m"};y=function(t){var e,n,r,i;e=t.p,n=t.screen;r=ld$.find(d.get("canvas"),"[ld=tracks]",0).getBoundingClientRect();i=r.height*((e||0)-k.timespan.min)/(k.timespan.max-k.timespan.min);if(n){i+=r.y}return i};s=function(t){var e;e=t.dur;return y({p:k.timespan.min+e})-y({p:k.timespan.min})};n=function(t){var e,n;e=t.dur,n=t.start;return y({p:e+n})-y({p:n})};u=function(t){var e,n,r,i,a;e=t.ctx;e.used=!e.used;e.p>=(n=(a=(r=k.timespan).min)<=(i=k.timespan.max)?a:r.min=i)||(e.p=n);e.y=y({p:e.p});if(e.used&&!in$(e,k.entries)){k.entries.push(e)}else if(!e.used&&in$(e,k.entries)){k.entries.splice(k.entries.indexOf(e),1)}return d.render()};c=function(t){var d,f,p,l,v;d=t.evt,f=t.view;p=!!d.shiftKey;l=p?1:undefined;v=k.tracks.filter(function(t){var e;e=t.box||(t.box={});return e.x<=k.refptr.x&&e.x+e.width>=k.refptr.x})[0]||{box:{}};k.ticks.filter(function(t){return t.moving}).map(function(t){var e,n;e=h({y:d.clientY,screen:true,grain:l});n=x({y:e,screen:true});t.y=e;t.p=n;return t.moving=false});k.entries.filter(function(t){return t.moving}).map(function(e){var t,n,r,i,a,u,s,c,o;t=f.get("tracks").getBoundingClientRect();n=m({y:h({y:d.clientY-k.refptr.delta,screen:true,grain:l})});r=x({y:n});if(!p){i=k.ticks.map(function(t){return{t:t,d:Math.min.apply(Math,[r-t.p,r+e.dur-t.p].map(function(t){return Math.abs(t)}))}});i.sort(function(t,e){return t.d-e.d});if((a=i[0])&&a.d<=10){a=a.t;if(Math.abs(r-a.p)<Math.abs(r+e.dur-a.p)){r=a.p}else{r=a.p-e.dur}}u=k.entries.filter(function(t){return t!==e}).map(function(t){return{e:t,d:Math.min.apply(Math,[r+e.dur-t.p,r-(t.p+t.dur)].map(function(t){return Math.abs(t)}))}});u.sort(function(t,e){return t.d-e.d});if((s=u[0])&&s.d<=10){c=s.e;if(Math.abs(r-(c.p+c.dur))<Math.abs(r+e.dur-c.p)){r=c.p+c.dur}else{r=c.p-e.dur}}}r>=(o=v.start)||(r=o);r<=(o=v.start+v.dur-e.dur)||(r=o);n=y({p:r});e.y=n;e.p=r;e.moving=false;if(v.id){return e.track=v.id}});return f.render("entry","tick","refline")};return d=new ldview({root:document.body,init:{ldcv:function(t){var e;e=t.node;return(k.ldcv||(k.ldcv={}))[e.getAttribute("data-name")]=new ldcover({root:e})}},action:{click:{"toggle-track-editor":function(t){var e,n,r;e=t.node,n=t.ctx,r=t.views;return k.ldcv["track-editor"].toggle()},"break-add":function(t){var e,n,r,i,a,u,s,c,o;e=t.node,n=t.ctx,r=t.views;i=k.tracks[0];a={id:Math.random(),track:i.id,p:i.start,dur:+d.get("break-min").value||30,data:{title:{zh:"休息時間",en:"Break Time"}}};a.p>=(u=(o=(s=k.timespan).min)<=(c=k.timespan.max)?o:s.min=c)||(a.p=u);a.y=y({p:a.p});k.entries.push(a);return r[0].render()}}},handler:{"track-editor":{handler:{track:{list:function(){return k.tracks},key:function(t){return t.id},view:{action:{click:{delete:function(t){var e;e=t.ctx;console.log(devTrack.indexOf(e));devTrack.splice(devTrack.indexOf(e),1);return trackEditorView.render()}}},text:{day:function(t){var e;e=t.ctx;return e.id},dur:function(t){var e,n,r,i;e=t.node,n=t.ctx;r=(n.dur-n.dur%60)/60;i=n.dur%60;return(r+"").padStart(2,"0")+":"+(i+"").padStart(2,"0")}},handler:{sel:function(t){var e,n,r,i,a,u;e=t.node,n=t.ctx;r=e.getAttribute("data-name");i=e.getAttribute("data-type");a=n.start+(r==="start"?0:n.dur);u=i==="hour"?(a-a%60)/60:a%60;return e.value=u}}}}}},session:{list:function(){return k.sessions},key:function(t){return t.id},view:{handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;return e.classList.toggle("used",!!n.used)}},text:{title:function(t){var e,n;e=t.node,n=t.ctx;return n.data.title.zh},speaker:function(t){var e,n;e=t.node,n=t.ctx;return n.data.speaker.map(function(t){return t.name}).join(" / ")}},action:{dragstart:{"@":function(t){var e,n;e=t.evt,n=t.ctx;return e.dataTransfer.setData("plain/text",n.id)}},click:{"@":function(t){var e,n;e=t.ctx,n=t.views;return u({ctx:e})}}}}},canvas:{action:{dragover:{"@":function(t){var e;e=t.evt;return e.preventDefault()}},drop:{"@":function(t){var e,n,r,i,a;e=t.evt,n=t.views;r=e.dataTransfer.getData("plain/text");i=k.sessions.filter(function(t){return t.id===r})[0];u({ctx:i});k.refptr.delta=0;i.moving=true;a=k.refptr;a.x=e.clientX;a.y=e.clientY;a.unsnap=!!e.shiftKey;n[0].render("tick","refline");c({evt:e,view:n[0]});return e.preventDefault()}},mousemove:{"@":function(t){var e,n,r;e=t.evt,n=t.views;r=k.refptr;r.x=e.clientX;r.y=e.clientY;r.unsnap=!!e.shiftKey;return n[0].render("tick","refline")}},mouseup:{"@":function(t){var e,n;e=t.evt,n=t.views;return c({evt:e,view:n[0]})}},click:{times:function(t){var e,n,r,i,a,u,s;e=t.node,n=t.evt,r=t.views;i=e.getBoundingClientRect();a=h({y:n.clientY,screen:true});u=x({y:a,screen:true});s=Math.random();k.ticks.push({y:a,p:u,id:s});return r[0].render()}}},handler:{time:{list:function(){return k.times},key:function(t){return t.p},view:{handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;e.style.top=y(n)+"px";e.classList.toggle("half",!(n.p%30));e.classList.toggle("full",!(n.p%60));if(!(n.p%60)){return e.innerText=n.p/60}}}}},refline:function(t){var e,n,r,i,a,u,s,c,o,d,f,p,l,v;e=t.node,n=t.views;r=k.refptr,i=r.x,a=r.y,u=r.unsnap;s=u?1:undefined;if(k.ticks.filter(function(t){return t.moving}).length){a=h({y:k.refptr.y||0,screen:true,grain:s});e.innerText=g({p:x({y:a,screen:true})});r=e.style;r.display="block";r.left="0px";r.top=m({y:a})+"px";r.width="100%";r.height=0;return}c=k.tracks.filter(function(t){var e;e=t.box||(t.box={});return e.x<=i&&e.x+e.width>=i})[0];o=k.entries.filter(function(t){return t.moving})[0];d=!!o;if(!c||!d){return r=e.style,r.display="none",r}f=n[0].get("tracks").getBoundingClientRect();p=n[0].get("@").getBoundingClientRect();l=c.box||{};v=y({p:o.p+o.dur})-y({p:o.p});a=h({y:(k.refptr.y||0)-k.refptr.delta,screen:true,grain:s});e.innerText=g({p:x({y:a,screen:true})});return r=e.style,r.display="block",r.left=(c.box.x||0)-p.x+"px",r.top=a-f.y+"px",r.width=(c.box.width||0)+"px",r.height=v+"px",r},tick:{list:function(){return k.ticks},key:function(t){return t.id},view:{action:{mousedown:{"@":function(t){var e;e=t.ctx;return e.moving=true}}},text:{"tick-inner":function(t){var e,n;e=t.node,n=t.ctx;return g(n)}},handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;return e.style.top=m({y:n.y})+"px"}}}},track:{list:function(){return k.tracks},key:function(t){return t.id},view:{handler:{"@":function(t){var e,n,r,i,a,u;e=t.node,n=t.ctx;r=s({dur:n.dur});i=y({p:n.start});a=e.style;a.transform="translate(0,"+i+"px)";a.height=r+"px";u=e.getBoundingClientRect();return n.box={x:u.x,y:u.y,width:u.width,height:u.height}}}}},entry:{list:function(){return k.entries},key:function(t){return t.id},view:{action:{mousedown:{"@":function(t){var e,n;e=t.ctx,n=t.evt;if(n.target.classList.contains("i-close")){return}k.refptr.delta=n.clientY-y({p:e.p,screen:true});return e.moving=true}},click:{"@":function(t){var e,n,r,i;e=t.ctx,n=t.node,r=t.evt,i=t.views;if(r.target.classList.contains("i-close")){e.used=false;if(in$(e,k.entries)){k.entries.splice(k.entries.indexOf(e),1)}}return i[2].render()}}},text:{title:function(t){var e,n;e=t.node,n=t.ctx;return n.data.title.zh},time:function(t){var e,n;e=t.node,n=t.ctx;return g(n)},dur:function(t){var e,n;e=t.node,n=t.ctx;return"("+r(n)+")"},speaker:function(t){var e,n;e=t.node,n=t.ctx;return n.data.speaker.map(function(t){return t.name}).join(" / ")}},handler:{"@":function(t){var e,n,r,i,a,u,s,c,o;e=t.node,n=t.ctx,r=t.views;if(!(i=k.tracks.filter(function(t){return t.id===n.track})[0])){return}a=r[1].get("tracks").getBoundingClientRect();u=r[1].get("@").getBoundingClientRect();s=i.box||{};c=s.height*(n.dur||1)/i.dur;return o=e.style,o.top=n.y+a.y-u.y+"px",o.left=s.x-u.x+"px",o.width=s.width+"px",o.height=c+"px",o}}}}}}}})})});function in$(t,e){var n=-1,r=e.length>>>0;while(++n<r)if(t===e[n])return true;return false}</script></body></html>